
{% macro announcement(announcement, link=True, edit_link=False, form_shim=False, smalltext=None) %}

{% if form_shim %} {# Shim the passed form to pretend it's an announcement. #}
  {% set announcement = {
    'title': announcement.title.data,
    'content': announcement.content.data
  }%}
{% endif %}

<div class="panel panel-default">
  <div class="panel-heading">
    <h3>
        {%- if link and not form_shim %}
          <a href="{{ url_for("announcement_page", announcement_id=announcement.id) }}">
            {{- announcement.title -}}
          </a>
        {%- else %}
          {{- announcement.title -}}
        {%- endif %}
        <small>
          {% if smalltext %}
          {{ smalltext }}
          {% else %}
          by {{ announcement.author.name }}
          on {{ announcement.timestamp.strftime("%B %d, %Y") }}
          {%- if edit_link %}
            <a href="{{ url_for("edit_announcement_page", announcement_id=announcement.id) }}">
              Edit
            </a>
          {%- endif %}
        </small>
        {% endif %} {# if smalltext #}
    </h3>
  </div>
  <div class="panel-body">
    {{ announcement.content | markdown }}
  </div>
</div>

{% endmacro %}

{% macro week(week, edit_link=False) %}
<div class="panel panel-default">
  <div class="panel-heading">
    <h3>
      {{ week.header }}
      {%- if edit_link %}
      <small>
        <a href="{{ url_for("edit_week_page",
                            semester_id=week.semester_id,
                            week_num=week.week_num) }}">
          Edit
        </a>
      </small>
      {%- endif %}
    </h3>
  </div>
  <div class="panel-body">
    <p class="text-primary">
    {{ week.intro | markdown }}
    </p>
    {% if week.assignments|length > 0 %}
    <hr>
    {% with assignment = week.assignments[0] %}
      <h4>{{ assignment.name }}</h4>
      {{ assignment.instructions | markdown }}
    {% endwith %}
    {% endif %}

    {% if week.documents|length > 0 %}
    <hr>
    <h4>Documents</h4>
    <p class="text-info">Click on a file to download it.</p>
    <div class="row">
      {% for document in week.documents %}
      <button class="col-xs-6 col-md-2 btn" 
      href="{{ url_for("document_page", document_id=document.id) }}"
      class="btn btn-primary" role="button" aria-pressed="true">
      {{ document.name }}
      </button>
      {% endfor %}
    </div>
    {% else %}
    <p class="text-muted col-xs-12">No documents to show.</p>
    {% endif %}
  </div>
</div>
{% endmacro %}

{% macro breadcrumbs(crumbs, current) %}
<ul class="breadcrumb">
  {% for text, link in crumbs %}
    <li><a href="{{link}}">{{text}}</a></li>
  {% endfor %}
  <li class="active">{{current}}</li>
</ul>
{% endmacro %}
